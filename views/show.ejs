<% layout("/layouts/boilerplate")%>

<div class="row">
    <div class="col-8 offset-3">
    <br><br>
         <h3><%=list.title%></h3>
   <div class="card col-10 listing-card " >
  <img src="<%=list.image.url%>" class="card-img-top show-img" alt="listings_img">
  <div class="card-body">
    <p class="card-text">
    <b>Owned by</b>:<i> <%=list.owner.username%>  </i></p>
   <p>  <%=list.description%></p> 
        <p> &#8377;<%=list.price.toLocaleString("en-IN")%></p> 
       <p>   <%=list.location%></p> 
     <p>    <%=list.country%></p> 
    </p>
  </div>
  </div>

  <%if (currentUser && currentUser._id.equals(list.owner._id)){%>
    <div class="twoBtns">
        <a href="/listings/<%=list._id%>/edit" >  <button class="btn btn-dark add-btn offset-5 px-4">Edit</button></a>      

    <form method="post" action="/listings/<%=list._id%>?_method=DELETE">
         <button class="btn btn-dark del-btn  offset-8">delete</button>
    </form>

    </div>
    <%}%>
    
     <br><br><hr>

    </div>


      <div class="col-8 offset-3">
        <% if (currentUser) {%>
      <h4>Leave a Review</h4>
      <form method="post" action="/listings/<%=list.id%>/reviews" novalidate class="needs-validation">
        <div class="mb-2  mt-3">
            <label for="rating" class="form-label">Rating </label><br>
            
<fieldset class="starability-slot small-stars">
  
  <input type="radio" id="no-rate" class="input-no-rate" name="review[rating]" value="1" checked aria-label="No rating." />
  <input type="radio" id="first-rate1" name="review[rating]" value="1" />
  <label for="first-rate1" title="Terrible">1 star</label>
  <input type="radio" id="first-rate2" name="review[rating]" value="2" />
  <label for="first-rate2" title="Not good">2 stars</label>
  <input type="radio" id="first-rate3" name="review[rating]" value="3" />
  <label for="first-rate3" title="Average">3 stars</label>
  <input type="radio" id="first-rate4" name="review[rating]" value="4" />
  <label for="first-rate4" title="Very good">4 stars</label>
  <input type="radio" id="first-rate5" name="review[rating]" value="5" />
  <label for="first-rate5" title="Amazing">5 stars</label>
</fieldset>


           
            </div>
            <div class="mb-3">
            <label for="comment" class="form-label">Comment</label> <br>
            <textarea rows="5" cols="50" class="form-control" name="review[comment]" required></textarea>
            <div class="invalid-feedback">please provide a comment for review</div><br>
            <button class="btn btn-outline-dark">submit</button><br>
        </div>
      </form>


  <hr>
      <%}%>
    
    
    
      <% if (list.reviews.length >0) {%>
    <div class="row">
        <p>All Reviews</p>
    <% for (let review of list.reviews){%>
      <div class="card col-md-5 ms-md-3 mb-3">
         <div class="card-body">
           <h5 class="card-title">@<%=review.author.username%></h5>
           <% for (let i=1;i<=review.rating;i++){ %>
               <i class="fa-solid fa-star fa-xs"></i>
              <%}%>
             
           <p class="card-text"><i><%=review.comment%></i></p>

        
           <form method="POST" action="/listings/<%=list.id%>/reviews/<%=review._id%>?_method=DELETE">
            <button class="btn btn-sm btn-dark">Delete</button>
           </form>
          
         </div>
      </div>
         
    <%}%>
    </div>
    <%}%>

     

    </div>
    </div>
       <!--
     <div class="col-8 offset-3 mb-3">
      <h3>Where you'll be</h3>
      <div id="map"></div>
    </div>
  

  


  <script>
	// TO MAKE THE MAP APPEAR YOU MUST
	// ADD YOUR ACCESS TOKEN FROM
	// https://account.mapbox.com
    console.log("TOKEN:", "<%= mapToken %>"); // should NOT be empty

  mapboxgl.accessToken = "<%= mapToken %>";

    const map = new mapboxgl.Map({
        container: 'map', // container ID
          style: 'mapbox://styles/mapbox/streets-v12',
        center: [-74.5, 40], // starting position [lng, lat]. Note that lat must be set between -90 and 90
        zoom: 9 // starting zoom
    });
</script>

 -->
